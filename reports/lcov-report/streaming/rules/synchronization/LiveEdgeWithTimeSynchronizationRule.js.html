<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for streaming\rules\synchronization\LiveEdgeWithTimeSynchronizationRule.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../prettify.css" />
    <link rel="stylesheet" href="../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../index.html">all files</a> / <a href="index.html">streaming/rules/synchronization/</a> LiveEdgeWithTimeSynchronizationRule.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">48% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>12/25</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">66.67% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>4/6</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">33.33% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>1/3</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">45.83% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>11/24</span>
      </div>
      <div class='fl pad1y'>
        <span class="strong">1 branch</span>
        <span class="quiet">Ignored</span>  &nbsp;&nbsp;&nbsp;&nbsp;
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * The copyright in this software is being made available under the BSD License,
 * included below. This software may be subject to other third party and contributor
 * rights, including patent rights, and no such rights are granted under this license.
 *
 * Copyright (c) 2013, Dash Industry Forum.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *  * Redistributions of source code must retain the above copyright notice, this
 *  list of conditions and the following disclaimer.
 *  * Redistributions in binary form must reproduce the above copyright notice,
 *  this list of conditions and the following disclaimer in the documentation and/or
 *  other materials provided with the distribution.
 *  * Neither the name of Dash Industry Forum nor the names of its
 *  contributors may be used to endorse or promote products derived from this software
 *  without specific prior written permission.
 *
 *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY
 *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 *  POSSIBILITY OF SUCH DAMAGE.
 */
&nbsp;
'use strict';
&nbsp;
Object.defineProperty(exports, '__esModule', {
    value: true
});
// istanbul ignore next
&nbsp;
function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? <span class="branch-0 cbranch-skip" title="branch not covered" >obj </span>: { 'default': obj }; }
&nbsp;
var _SwitchRequest = require('../SwitchRequest');
&nbsp;
var _SwitchRequest2 = _interopRequireDefault(_SwitchRequest);
&nbsp;
var _coreFactoryMaker = require('../../../core/FactoryMaker');
&nbsp;
var _coreFactoryMaker2 = _interopRequireDefault(_coreFactoryMaker);
&nbsp;
<span class="fstat-no" title="function not covered" >function LiveEdgeWithTimeSynchronizationRule(config) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var instance = undefined;</span>
<span class="cstat-no" title="statement not covered" >    var context = this.context;</span>
<span class="cstat-no" title="statement not covered" >    var timelineConverter = config.timelineConverter;</span>
&nbsp;
    // if the time has been synchronized correctly (which it must have been
    // to end up executing this rule), the last entry in the DVR window
    // should be the live edge. if that is incorrect for whatever reason,
    // playback will fail to start and some other action should be taken.
<span class="fstat-no" title="function not covered" >    function execute(rulesContext, callback) {</span>
<span class="cstat-no" title="statement not covered" >        var representationInfo = rulesContext.getTrackInfo();</span>
<span class="cstat-no" title="statement not covered" >        var liveEdgeInitialSearchPosition = representationInfo.DVRWindow.end;</span>
<span class="cstat-no" title="statement not covered" >        var p = _SwitchRequest2['default'].DEFAULT;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (representationInfo.useCalculatedLiveEdgeTime) {</span>
            //By default an expected live edge is the end of the last segment.
            // A calculated live edge ('end' property of a range returned by TimelineConverter.calcSegmentAvailabilityRange)
            // is used as an initial point for finding the actual live edge.
            // But for SegmentTimeline mpds (w/o a negative @r) the end of the
            // last segment is the actual live edge. At the same time, calculated live edge is an expected live edge.
            // Thus, we need to switch an expected live edge and actual live edge for SegmentTimeline streams.
<span class="cstat-no" title="statement not covered" >            var actualLiveEdge = timelineConverter.getExpectedLiveEdge();</span>
<span class="cstat-no" title="statement not covered" >            timelineConverter.setExpectedLiveEdge(liveEdgeInitialSearchPosition);</span>
<span class="cstat-no" title="statement not covered" >            callback((0, _SwitchRequest2['default'])(context).create(actualLiveEdge, p));</span>
        } else {
<span class="cstat-no" title="statement not covered" >            callback((0, _SwitchRequest2['default'])(context).create(liveEdgeInitialSearchPosition, p));</span>
        }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    instance = {</span>
        execute: execute
    };
&nbsp;
<span class="cstat-no" title="statement not covered" >    return instance;</span>
}
&nbsp;
LiveEdgeWithTimeSynchronizationRule.__dashjs_factory_name = 'LiveEdgeWithTimeSynchronizationRule';
exports['default'] = _coreFactoryMaker2['default'].getClassFactory(LiveEdgeWithTimeSynchronizationRule);
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6L0FwYWNoZTI0L2h0ZG9jcy9NeURhc2gvc3JjL3N0cmVhbWluZy9ydWxlcy9zeW5jaHJvbml6YXRpb24vTGl2ZUVkZ2VXaXRoVGltZVN5bmNocm9uaXphdGlvblJ1bGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs2QkErQjBCLGtCQUFrQjs7OztnQ0FDbkIsNEJBQTRCOzs7O0FBRXJELFNBQVMsbUNBQW1DLENBQUMsTUFBTSxFQUFFOztBQUVqRCxRQUFJLFFBQVEsWUFBQSxDQUFDO0FBQ2IsUUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztBQUMzQixRQUFJLGlCQUFpQixHQUFHLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQzs7Ozs7O0FBTWpELGFBQVMsT0FBTyxDQUFDLFlBQVksRUFBRSxRQUFRLEVBQUU7QUFDckMsWUFBSSxrQkFBa0IsR0FBRyxZQUFZLENBQUMsWUFBWSxFQUFFLENBQUM7QUFDckQsWUFBSSw2QkFBNkIsR0FBRyxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDO0FBQ3JFLFlBQUksQ0FBQyxHQUFHLDJCQUFjLE9BQU8sQ0FBQzs7QUFFOUIsWUFBSSxrQkFBa0IsQ0FBQyx5QkFBeUIsRUFBRTs7Ozs7OztBQU85QyxnQkFBSSxjQUFjLEdBQUcsaUJBQWlCLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztBQUM3RCw2QkFBaUIsQ0FBQyxtQkFBbUIsQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO0FBQ3JFLG9CQUFRLENBQUMsZ0NBQWMsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQzlELE1BQU07QUFDSCxvQkFBUSxDQUFDLGdDQUFjLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyw2QkFBNkIsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQzdFO0tBQ0o7O0FBRUQsWUFBUSxHQUFHO0FBQ1AsZUFBTyxFQUFFLE9BQU87S0FDbkIsQ0FBQzs7QUFFRixXQUFPLFFBQVEsQ0FBQztDQUNuQjs7QUFFRCxtQ0FBbUMsQ0FBQyxxQkFBcUIsR0FBRyxxQ0FBcUMsQ0FBQztxQkFDbkYsOEJBQWEsZUFBZSxDQUFDLG1DQUFtQyxDQUFDIiwiZmlsZSI6IkM6L0FwYWNoZTI0L2h0ZG9jcy9NeURhc2gvc3JjL3N0cmVhbWluZy9ydWxlcy9zeW5jaHJvbml6YXRpb24vTGl2ZUVkZ2VXaXRoVGltZVN5bmNocm9uaXphdGlvblJ1bGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRoZSBjb3B5cmlnaHQgaW4gdGhpcyBzb2Z0d2FyZSBpcyBiZWluZyBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgQlNEIExpY2Vuc2UsXG4gKiBpbmNsdWRlZCBiZWxvdy4gVGhpcyBzb2Z0d2FyZSBtYXkgYmUgc3ViamVjdCB0byBvdGhlciB0aGlyZCBwYXJ0eSBhbmQgY29udHJpYnV0b3JcbiAqIHJpZ2h0cywgaW5jbHVkaW5nIHBhdGVudCByaWdodHMsIGFuZCBubyBzdWNoIHJpZ2h0cyBhcmUgZ3JhbnRlZCB1bmRlciB0aGlzIGxpY2Vuc2UuXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDEzLCBEYXNoIEluZHVzdHJ5IEZvcnVtLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQgbW9kaWZpY2F0aW9uLFxuICogYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuICogICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLCB0aGlzXG4gKiAgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKiAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsXG4gKiAgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3JcbiAqICBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuICogICogTmVpdGhlciB0aGUgbmFtZSBvZiBEYXNoIEluZHVzdHJ5IEZvcnVtIG5vciB0aGUgbmFtZXMgb2YgaXRzXG4gKiAgY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZVxuICogIHdpdGhvdXQgc3BlY2lmaWMgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLlxuICpcbiAqICBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIEFTIElTIEFORCBBTllcbiAqICBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEXG4gKiAgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELlxuICogIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBDT1BZUklHSFQgSE9MREVSIE9SIENPTlRSSUJVVE9SUyBCRSBMSUFCTEUgRk9SIEFOWSBESVJFQ1QsXG4gKiAgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVFxuICogIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwgT1JcbiAqICBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORCBPTiBBTlkgVEhFT1JZIE9GIExJQUJJTElUWSxcbiAqICBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpXG4gKiAgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVMgU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEVcbiAqICBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cbiAqL1xuXG5pbXBvcnQgU3dpdGNoUmVxdWVzdCBmcm9tICcuLi9Td2l0Y2hSZXF1ZXN0JztcbmltcG9ydCBGYWN0b3J5TWFrZXIgZnJvbSAnLi4vLi4vLi4vY29yZS9GYWN0b3J5TWFrZXInO1xuXG5mdW5jdGlvbiBMaXZlRWRnZVdpdGhUaW1lU3luY2hyb25pemF0aW9uUnVsZShjb25maWcpIHtcblxuICAgIGxldCBpbnN0YW5jZTtcbiAgICBsZXQgY29udGV4dCA9IHRoaXMuY29udGV4dDtcbiAgICBsZXQgdGltZWxpbmVDb252ZXJ0ZXIgPSBjb25maWcudGltZWxpbmVDb252ZXJ0ZXI7XG5cbiAgICAvLyBpZiB0aGUgdGltZSBoYXMgYmVlbiBzeW5jaHJvbml6ZWQgY29ycmVjdGx5ICh3aGljaCBpdCBtdXN0IGhhdmUgYmVlblxuICAgIC8vIHRvIGVuZCB1cCBleGVjdXRpbmcgdGhpcyBydWxlKSwgdGhlIGxhc3QgZW50cnkgaW4gdGhlIERWUiB3aW5kb3dcbiAgICAvLyBzaG91bGQgYmUgdGhlIGxpdmUgZWRnZS4gaWYgdGhhdCBpcyBpbmNvcnJlY3QgZm9yIHdoYXRldmVyIHJlYXNvbixcbiAgICAvLyBwbGF5YmFjayB3aWxsIGZhaWwgdG8gc3RhcnQgYW5kIHNvbWUgb3RoZXIgYWN0aW9uIHNob3VsZCBiZSB0YWtlbi5cbiAgICBmdW5jdGlvbiBleGVjdXRlKHJ1bGVzQ29udGV4dCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHJlcHJlc2VudGF0aW9uSW5mbyA9IHJ1bGVzQ29udGV4dC5nZXRUcmFja0luZm8oKTtcbiAgICAgICAgdmFyIGxpdmVFZGdlSW5pdGlhbFNlYXJjaFBvc2l0aW9uID0gcmVwcmVzZW50YXRpb25JbmZvLkRWUldpbmRvdy5lbmQ7XG4gICAgICAgIHZhciBwID0gU3dpdGNoUmVxdWVzdC5ERUZBVUxUO1xuXG4gICAgICAgIGlmIChyZXByZXNlbnRhdGlvbkluZm8udXNlQ2FsY3VsYXRlZExpdmVFZGdlVGltZSkge1xuICAgICAgICAgICAgLy9CeSBkZWZhdWx0IGFuIGV4cGVjdGVkIGxpdmUgZWRnZSBpcyB0aGUgZW5kIG9mIHRoZSBsYXN0IHNlZ21lbnQuXG4gICAgICAgICAgICAvLyBBIGNhbGN1bGF0ZWQgbGl2ZSBlZGdlICgnZW5kJyBwcm9wZXJ0eSBvZiBhIHJhbmdlIHJldHVybmVkIGJ5IFRpbWVsaW5lQ29udmVydGVyLmNhbGNTZWdtZW50QXZhaWxhYmlsaXR5UmFuZ2UpXG4gICAgICAgICAgICAvLyBpcyB1c2VkIGFzIGFuIGluaXRpYWwgcG9pbnQgZm9yIGZpbmRpbmcgdGhlIGFjdHVhbCBsaXZlIGVkZ2UuXG4gICAgICAgICAgICAvLyBCdXQgZm9yIFNlZ21lbnRUaW1lbGluZSBtcGRzICh3L28gYSBuZWdhdGl2ZSBAcikgdGhlIGVuZCBvZiB0aGVcbiAgICAgICAgICAgIC8vIGxhc3Qgc2VnbWVudCBpcyB0aGUgYWN0dWFsIGxpdmUgZWRnZS4gQXQgdGhlIHNhbWUgdGltZSwgY2FsY3VsYXRlZCBsaXZlIGVkZ2UgaXMgYW4gZXhwZWN0ZWQgbGl2ZSBlZGdlLlxuICAgICAgICAgICAgLy8gVGh1cywgd2UgbmVlZCB0byBzd2l0Y2ggYW4gZXhwZWN0ZWQgbGl2ZSBlZGdlIGFuZCBhY3R1YWwgbGl2ZSBlZGdlIGZvciBTZWdtZW50VGltZWxpbmUgc3RyZWFtcy5cbiAgICAgICAgICAgIHZhciBhY3R1YWxMaXZlRWRnZSA9IHRpbWVsaW5lQ29udmVydGVyLmdldEV4cGVjdGVkTGl2ZUVkZ2UoKTtcbiAgICAgICAgICAgIHRpbWVsaW5lQ29udmVydGVyLnNldEV4cGVjdGVkTGl2ZUVkZ2UobGl2ZUVkZ2VJbml0aWFsU2VhcmNoUG9zaXRpb24pO1xuICAgICAgICAgICAgY2FsbGJhY2soU3dpdGNoUmVxdWVzdChjb250ZXh0KS5jcmVhdGUoYWN0dWFsTGl2ZUVkZ2UsIHApKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKFN3aXRjaFJlcXVlc3QoY29udGV4dCkuY3JlYXRlKGxpdmVFZGdlSW5pdGlhbFNlYXJjaFBvc2l0aW9uLCBwKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpbnN0YW5jZSA9IHtcbiAgICAgICAgZXhlY3V0ZTogZXhlY3V0ZVxuICAgIH07XG5cbiAgICByZXR1cm4gaW5zdGFuY2U7XG59XG5cbkxpdmVFZGdlV2l0aFRpbWVTeW5jaHJvbml6YXRpb25SdWxlLl9fZGFzaGpzX2ZhY3RvcnlfbmFtZSA9ICdMaXZlRWRnZVdpdGhUaW1lU3luY2hyb25pemF0aW9uUnVsZSc7XG5leHBvcnQgZGVmYXVsdCBGYWN0b3J5TWFrZXIuZ2V0Q2xhc3NGYWN0b3J5KExpdmVFZGdlV2l0aFRpbWVTeW5jaHJvbml6YXRpb25SdWxlKTsiXX0=</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun Jan 15 2017 21:03:55 GMT+0800 (中国标准时间)
</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
